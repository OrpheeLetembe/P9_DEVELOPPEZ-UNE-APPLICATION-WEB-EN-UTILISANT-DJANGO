{% extends "blog/base.html" %}
{% load static %}
{% load blog_extras %}

{% block title %}Voir vos propres post{% endblock %}

{% block content %}
    <h1 class="post">Vos posts</h1>

    {% for instance in reviews_and_tickets %}
        {% if instance|model_type == 'Ticket' %}
            <div class="ticket_post content_style">
                <h2>Vous avez publié un ticket</h2>
                <h2 class="date"> {{instance.time_created|date:"h:i, j F Y"}} </h2>
                <h2> {{instance.title}} - {{instance.description}}</h2>
                <div class="ticket_img_btn">
                     <img class="ticket_post_img" src="{{instance.image.url}}">
                    <div class="post_btns">
                        <div class="btn_update">
                            <form  action="{% url 'ticket_update' instance.id %}" method='get' >
                                 {% csrf_token %}
                                <input class="btn btns btn-outline-dark" type='submit' value="Modifier">
                            </form>
                        </div>
                        <div class="btn_delete">
                            <form  action="{% url 'ticket_delete' instance.id %}" method='get' >
                                 {% csrf_token %}
                                <input class="btn btns btn-outline-dark" type='submit' value="Supprimer">
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        {% elif instance|model_type == 'Review' %}
            <div class="review_post content_style">
                <h2>Vous avez publié une critique</h2>
                <h2 class="date"> {{instance.time_created|date:"h:i, j F Y"}} </h2>
                <table class="rating">
                    <tr>
                        <td>
                            <h2>{{instance.headline}} -</h2>
                        </td>
                        <td>
                            <div style="width: calc(20% * {{instance.rating}})"></div>
                            <img src="{% static '/blog/image/stars.png'%}">
                        </td>
                    </tr>
                </table>
                <h2>{{instance.body}}</h2>
                <div class="ticket_review">
                    <div class="ticket_review_content">
                        <h2>Ticket - {% get_user_display instance.ticket.user %}</h2>
                        <h2>{{instance.ticket.title}} - {{instance.ticket.description}}</h2>
                        <p><img class="ticket_post_img" src="{{instance.ticket.image.url}}"></p>
                    </div>
                    <div class="post_btns">
                        <div class="btn_update">
                            <form  action="{% url 'review_update' instance.id %}" method='get' >
                                 {% csrf_token %}
                                <input class="btn btns btn-outline-dark" type='submit' value="Modifier">
                            </form>
                        </div>
                        <div class="btn_delete">
                            <form  action="{% url 'review_delete' instance.id %}" method='get' >
                                 {% csrf_token %}
                                <input class="btn btns btn-outline-dark" type='submit' value="Supprimer">
                            </form>
                        </div>
                    </div>
                </div>
            </div>

        {% endif %}
    {% endfor %}

{% endblock content %}